<!--
created by kasunrachintha on 9/19/22
@author : kasunrachintha
@Date :  9/19/22
@Time: 12:50 pm
@Project : My-Portfolio
-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Manage Item</title>
    <meta content="width=device-width initial-scale=1" name="viewport">
    <link href="../assets/css/styles/Stylesheet.css" rel="stylesheet">
    <link href="../assets/css/bootstrap.min.css" rel="stylesheet">

</head>
<body>
<main>

    <!--  start header -->
    <header>
        <!--start nav bar with image and name-->
        <nav class="navbar navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="#">
                    <img alt="Logo" class="d-inline-block align-text-top" height="30" src="../assets/images/store.png"
                         width="30">
                    POS System
                </a>

                <!--start nav bar with navigations links(home,customer,item...)-->
                <nav class="navbar navbar-expand-lg bg-light">
                    <div class="container-fluid">
                        <a class="navbar-brand" href="#"></a>
                        <button aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"
                                class="navbar-toggler" data-bs-target="#navbarNavAltMarkup"
                                data-bs-toggle="collapse" type="button">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                        <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
                            <div class="navbar-nav">
                                <a aria-current="page" class="nav-link active" href="../index.html">Home</a>
                                <a class="nav-link" href="customer.html">Customer</a>
                                <a class="nav-link" href="#">Item</a>
                                <a class="nav-link" href="order.html">Order</a>
                            </div>
                        </div>

                        <!-- start logout icon -->
                        <nav class="navbar bg-light">
                            <div class="container">
                                <a class="navbar-brand" href="../Pages/SignIn.html">
                                    <img alt="Bootstrap" height="24" src="../assets/images/log_out.svg" width="30">
                                </a>
                            </div>
                        </nav>
                        <!-- end logout icon -->

                    </div>
                </nav>
                <!--end nav bar with navigations links(home,item,item...)-->

            </div>
        </nav>
        <!--end nav bar with image and name-->

    </header>
    <!--  end header -->


    <br>
    <br>

    <!-- Start Item Here-->
    <div>
        <h1 class="container-fluid"><span class="headline_part1">Manage</span> <span
                class="headline_part2">Item</span></h1>
    </div>

    <br>
    <br>

    <!-- start Item search and add new Item section-->
    <section class="container-fluid row">

        <nav class="navbar bg-white">
            <div class="container-fluid">
                <!-- start + new item button-->
                <button class="btn btn-outline-primary" data-bs-target="#staticBackdropforaddnewitem"
                        data-bs-toggle="modal"
                        type="button">Add New Item
                </button>
                <!-- end + new Item button-->

                <!-- start item search-->
                <form class="d-flex" role="search">
                    <input id="myInput" aria-label="Search" class="form-control me-2 " placeholder="ItemCode/Name" type="search">
                    <button class="btn btn-outline-success" type="submit">Search</button>
                </form>
            </div>
        </nav>
        <!-- end item search-->

        <!-- Modal for Add New Item popup Form-->
        <section>
            <div aria-hidden="true" aria-labelledby="staticBackdropLabel" class="modal fade" data-bs-backdrop="static"
                 data-bs-keyboard="false" id="staticBackdropforaddnewitem" tabindex="-1">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="staticBackdropforaddnewitemlable">Add New Item</h5>
                            <button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button>
                        </div>
                        <div class="modal-body">

                            <!-- start form here -->
                            <form id="addNewItemForm">

                                <div class="form-floating mb-2">
                                    <input class="form-control" id="txtItemCode" placeholder="I-001" type="text">
                                    <label for="txtItemCode">Item Code</label>
                                </div>

                                <div class="form-floating mb-2">
                                    <input class="form-control" id="txtItemName" placeholder="chocolate biscuit"
                                           type="text">
                                    <label for="txtItemName">Item Name</label>
                                </div>

                                <div class="form-floating mb-2">
                                    <input class="form-control" id="txtItemQTYOnHand" placeholder="100"
                                           type="number">
                                    <label for="txtItemQTYOnHand">QTY On Hand</label>
                                </div>

                                <div class="form-floating mb-2">
                                    <input class="form-control" id="txtItemPrice" placeholder="100.00"
                                           type="number">
                                    <label for="txtItemPrice">Price</label>
                                </div>
                            </form>
                            <!-- end form here -->
                            <button class="btn btn-success" id="getAll" type="button">Get All</button>

                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-secondary" data-bs-dismiss="modal" type="button">Close</button>
                            <button class="btn btn-primary" id="btnClear" type="button">Clear</button>
                            <button class="btn btn-primary" id="btnSaveItem" type="button">Save</button>
                        </div>
                    </div>
                </div>
            </div>

        </section>

    </section>
    <!-- end Item search and add new Item section-->

    <br>
    <br>

    <!-- start Item data store table -->
    <section class="container-fluid">
        <table class="table table-bordered table-hover">
            <thead class="bg-info text-white">
            <tr class="table-danger">
                <td>Item Code</td>
                <td>Name</td>
                <td>QtyOnHand</td>
                <td>Price</td>
                <td>Action</td>
            </tr>
            </thead>

            <tbody id="tblItem">

            </tbody>
        </table>

        <!-- Modal for Update Item popup Form-->
        <section>
            <!-- Modal -->
            <div aria-hidden="true" aria-labelledby="staticBackdropLabel" class="modal fade" data-bs-backdrop="static"
                 data-bs-keyboard="false" id="staticBackdropforUpdateItem" tabindex="-1">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="staticBackdropforUpdateItemlable">Update Item</h5>
                            <button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button>
                        </div>
                        <div class="modal-body">

                            <!-- start form here -->
                            <form id="updateItemForm">

                                <div class="form-floating mb-2">
                                    <input class="form-control" id="floatingUpdateItemCode" placeholder="I-001"
                                           type="text">
                                    <label for="floatingUpdateItemCode">Item Code</label>
                                </div>

                                <div class="form-floating mb-2">
                                    <input class="form-control" id="floatingUpdatItemName"
                                           placeholder="chocolate biscuit" type="text">
                                    <label for="floatingUpdatItemName">Item Name</label>
                                </div>

                                <div class="form-floating mb-2">
                                    <input class="form-control" id="floatingUpdateItemQTYOnHand" placeholder="100"
                                           type="number">
                                    <label for="floatingUpdateItemQTYOnHand">QTY On Hand</label>
                                </div>

                                <div class="form-floating mb-2">
                                    <input class="form-control" id="floatingUpdateItemPrice" placeholder="100.00"
                                           type="number">
                                    <label for="floatingUpdateItemPrice">Price</label>
                                </div>
                            </form>
                            <!-- end form here -->

                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-secondary" data-bs-dismiss="modal" type="button">Close</button>
                            <button class="btn btn-primary" type="button">Update</button>
                        </div>
                    </div>
                </div>
            </div>


        </section>
    </section>
    <!-- end Item data store table -->

    <!-- End Item Here-->

</main>

<!--Import js for bootstrap-->
<script src="../assets/js/bootstrap.min.js"></script>
<script src="../assets/js/jquery-3.6.1.min.js"></script>
<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>

    //create global scope array
    var items = [];

    //btn save item
    $('#btnSaveItem').click(function () {
        let itemID = $('#txtItemCode').val();
        let itemName = $('#txtItemName').val();
        let itemQtyOnHand = $('#txtItemQTYOnHand').val();
        let itemPrice = $('#txtItemPrice').val();

        //crate object
        var itemObject = {
            id: itemID,
            name: itemName,
            qtyOnHand: itemQtyOnHand,
            price: itemPrice
        }

        //add object into array using push();
        items.push(itemObject);

        //call load all item
        loadAllItems();

        //call clear from input data
        clearData();

        //call save sweet alert
        saveAlert()
    });


    //btn get all
    $('#getAll').click(function () {
        loadAllItems();
    });

    //btn clear data from input
    $('#btnClear').click(function () {
        clearData();
    });


    //load All items data into table
    function loadAllItems() {
        $('#tblItem').empty();

        for (var item of items) {
            var row = `<tr><td>${item.id}</td><td>${item.name}</td><td>${item.qtyOnHand}</td><td>${item.price}</td><td> <button id="btnUpdateItem" class="btn btn-outline-info col-12 col-sm-7 col-lg-3 mb-1" data-bs-target="#staticBackdropforUpdateItem" data-bs-toggle="modal" type="button">Edit</button> <button id="btnDeleteItem" class="btn btn-outline-danger col-12 col-sm-7 col-lg-3 mb-1" type="button">Delete</button></td></tr>`;
            $('#tblItem').append(row);
        }
    }

    //clear input data
    function clearData() {
        $('#txtItemCode').val('');
        $('#txtItemName').val('');
        $('#txtItemQTYOnHand').val('');
        $('#txtItemPrice').val('');
    }

    //auto fill update form
    $('#tblItem').on('click', '#btnUpdateItem', function () {
        var row = $(this).closest('tr');
        var td = $(row).find('td');

        $('#floatingUpdateItemCode').val($(td).eq(0).html());
        $('#floatingUpdatItemName').val($(td).eq(1).html());
        $('#floatingUpdateItemQTYOnHand').val($(td).eq(2).html());
        $('#floatingUpdateItemPrice').val($(td).eq(3).html());
    });

    //delete item row
    $('#tblItem').on('click', '#btnDeleteItem', function () {

        Swal.fire({
            title: 'Are you sure?',
            text: "You won't be able to revert this!",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Yes, delete it!'
        }).then((result) => {
            if (result.isConfirmed) {
                $(this).closest('tr').remove();
                Swal.fire(
                    'Deleted!',
                    'Your file has been deleted.',
                    'success'
                )
            }
        })

    });


    //added Item Search
    $('#myInput').on('keyup', function () {
        var value = $(this).val().toLowerCase();
        $('#tblItem tr').filter(function () {
            $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
        });
    });

    //when press enter input field auto focus
    $('.form-control').on('keydown',function (event){
       if(event.which == 13){
           var index = $('.form-control').index(this) + 1;
           $('.form-control').eq(index).focus();
       }
    });

    //press enter when price input field  save item data
    $('#txtItemPrice').on('keydown',function(event){
       if(event.which == 13){
           $('#btnSaveItem').focus();
       }
    });

    //save sweet alert
    function saveAlert(){
        Swal.fire({
            position: 'top-end',
            icon: 'success',
            title: 'Your work has been saved',
            showConfirmButton: false,
            timer: 1500
        })
    }


</script>
</body>
</html>