<!--
created by kasunrachintha on 9/19/22
@author : kasunrachintha
@Date :  9/19/22
@Time: 12:47 pm
@Project : My-Portfolio
-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Manage Customer</title>
    <meta content="width=device-width initial-scale=1" name="viewport">
    <link href="../assets/css/styles/Stylesheet.css" rel="stylesheet">
    <link href="../assets/css/bootstrap.min.css" rel="stylesheet">

</head>
<body>
<main>

    <!--  start header -->
    <header>
        <!--start nav bar with image and name-->
        <nav class="navbar navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="#">
                    <img alt="Logo" class="d-inline-block align-text-top" height="30" src="../assets/images/store.png"
                         width="30">
                    POS System
                </a>

                <!--start nav bar with navigations links(home,customer,item...)-->
                <nav class="navbar navbar-expand-lg bg-light">
                    <div class="container-fluid">
                        <a class="navbar-brand" href="#"></a>
                        <button aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"
                                class="navbar-toggler" data-bs-target="#navbarNavAltMarkup"
                                data-bs-toggle="collapse" type="button">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                        <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
                            <div class="navbar-nav">
                                <a aria-current="page" class="nav-link active" href="../index.html">Home</a>
                                <a class="nav-link" href="#">Customer</a>
                                <a class="nav-link" href="item.html">Item</a>
                                <a class="nav-link" href="order.html">Order</a>
                            </div>
                        </div>

                        <!-- start logout icon -->
                        <nav class="navbar bg-light">
                            <div class="container">
                                <a class="navbar-brand" href="../Pages/SignIn.html">
                                    <img alt="Bootstrap" height="24" src="../assets/images/log_out.svg" width="30">
                                </a>
                            </div>
                        </nav>
                        <!-- end logout icon -->

                    </div>
                </nav>
                <!--end nav bar with navigations links(home,customer,item...)-->

            </div>
        </nav>
        <!--end nav bar with image and name-->

    </header>
    <!--  end header -->

    <br>
    <br>

    <!-- Start Customer Here-->
    <div>
        <h1 class="container-fluid"><span class="headline_part1">Manage</span> <span
                class="headline_part2">Customer</span></h1>
    </div>

    <br>
    <br>

    <!-- start customer search and add new customer section-->
    <section class="container-fluid row">

        <!-- start customer search-->
        <nav class="navbar bg-white">
            <div class="container-fluid">
                <!-- start add new customer button-->
                <button class="btn btn-outline-primary" data-bs-target="#staticBackdropforaddnewcustomer"
                        data-bs-toggle="modal"

                        type="button">Add New Customer
                </button>
                <!-- end add new customer button-->

                <!-- start customer search-->
                <form class="d-flex" role="search">
                    <input aria-label="Search" class="form-control me-2 " id="myInput" placeholder="CustomerID/NIC/Name"
                           type="search">
                    <button class="btn btn-outline-success" type="submit">Search</button>
                </form>
            </div>
        </nav>
        <!-- end customer search-->

        <!-- Modal for Add new customer popup Form-->
        <section>
            <div aria-hidden="true" aria-labelledby="staticBackdropLabel" class="modal fade"
                 data-bs-backdrop="static" data-bs-keyboard="false" id="staticBackdropforaddnewcustomer" tabindex="-1">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="staticBackdropforaddnewcustomerLable">Add New Customer</h5>
                            <button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button>
                        </div>
                        <div class="modal-body">

                            <!-- start form here -->
                            <form id="addNewCustomerForm">

                                <div class="form-floating mb-2">
                                    <input class="form-control" id="txtCustomerID" placeholder="C-001" type="text">
                                    <label for="txtCustomerID">Customer ID</label>
                                </div>

                                <div class="form-floating mb-2">
                                    <input class="form-control" id="txtName" placeholder="Kasun Weerasinghe"
                                           type="text">
                                    <label for="txtName">Name</label>
                                </div>

                                <div class="form-floating mb-2">
                                    <input class="form-control" id="txtAddress" placeholder="Wennappuwa"
                                           type="text">
                                    <label for="txtAddress">Address</label>
                                </div>

                                <div class="form-floating mb-2">
                                    <input class="form-control" id="txtContact" placeholder="077-8428433"
                                           type="text">
                                    <label for="txtContact">Contact</label>
                                </div>

                                <div class="form-floating mb-2">
                                    <input class="form-control" id="txtSalary" placeholder="24" type="number">
                                    <label for="txtSalary">Salary</label>
                                </div>
                            </form>
                            <!-- end form here -->

                            <button class="btn btn-success" id="getAll" type="button">Get All</button>

                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-secondary" data-bs-dismiss="modal" type="button">Close</button>
                            <button class="btn btn-primary" id="btnClear" type="button">Clear</button>
                            <button class="btn btn-primary" id="btnSaveCustomer" type="button">Save</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </section>
    <!-- end customer search and add new customer section-->

    <br>
    <br>

    <!-- start customer data store table -->
    <section class="container-fluid">
        <table class="table table-bordered table-hover">
            <thead class="bg-info text-white">
            <tr class="table-warning">
                <td>Customer Id</td>
                <td>Name</td>
                <td>Address</td>
                <td>Contact</td>
                <td>Salary</td>
                <td>Action</td>
            </tr>
            </thead>

            <tbody id="tblCustomer">

            </tbody>
        </table>

        <!-- Modal for Update customer popup Form-->
        <section>
            <div aria-hidden="true" aria-labelledby="staticBackdropLabel" class="modal fade"
                 data-bs-backdrop="static" data-bs-keyboard="false" id="staticBackdropforupdatecustomer" tabindex="-1">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="staticBackdropforupdatecustomerlable">Update Customer</h5>
                            <button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button>
                        </div>
                        <div class="modal-body">

                            <!-- start form here -->
                            <form id="updateCustomerForm">

                                <div class="form-floating mb-2">
                                    <input class="form-control" id="floatingUpdateCustomerID" placeholder="C-001"
                                           type="text">
                                    <label for="floatingUpdateCustomerID">Customer ID</label>
                                </div>

                                <div class="form-floating mb-2">
                                    <input class="form-control" id="floatingUpdateName" placeholder="Kasun Weerasinghe"
                                           type="text">
                                    <label for="floatingUpdateName">Name</label>
                                </div>

                                <div class="form-floating mb-2">
                                    <input class="form-control" id="floatingUpdateAddress" placeholder="Wennappuwa"
                                           type="text">
                                    <label for="floatingUpdateAddress">Address</label>
                                </div>

                                <div class="form-floating mb-2">
                                    <input class="form-control" id="floatingUpdateContact" placeholder="077-8428433"
                                           type="text">
                                    <label for="floatingUpdateContact">Contact</label>
                                </div>

                                <div class="form-floating mb-2">
                                    <input class="form-control" id="floatingUpdateSalary" placeholder="24"
                                           type="number">
                                    <label for="floatingUpdateSalary">Salary</label>
                                </div>
                            </form>
                            <!-- end form here -->


                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-secondary" data-bs-dismiss="modal" type="button">Close</button>
                            <button class="btn btn-primary" id="btnCustomerUpdateSave" type="button">Update</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </section>
    <!-- end customer data store table -->

    <!-- End Customer Here-->

</main>

<!--Import js for bootstrap-->
<script src="../assets/js/bootstrap.min.js"></script>
<script src="../assets/js/jquery-3.6.1.min.js"></script>

<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>

    //create global scope array
    var customers = [];

    //btn save customer
    $('#btnSaveCustomer').click(function () {
        let customerID = $('#txtCustomerID').val();
        let customerName = $('#txtName').val();
        let customerAddress = $('#txtAddress').val();
        let customerContact = $('#txtContact').val();
        let customerSalary = $('#txtSalary').val();

        //create object
        var customerObject = {
            id: customerID,
            name: customerName,
            address: customerAddress,
            contact: customerContact,
            salary: customerSalary
        }

        //add object into array using push();
        customers.push(customerObject);

        //call load all customer
        loadAllCustomers();

        //call clear from input data
        clearData();

        //call save sweet alert
        saveAlert();

    });


    //btn get all
    $('#getAll').click(function () {
        loadAllCustomers();
    });

    //btn clear data from input
    $('#btnClear').click(function () {
        clearData();
    });

    //clear input data
    function clearData() {
        $('#txtCustomerID').val('');
        $('#txtName').val('');
        $('#txtAddress').val('');
        $('#txtContact').val('');
        $('#txtSalary').val('');
    }

    //load All customers data into table
    function loadAllCustomers() {
        //remove all the table body content before adding
        $('#tblCustomer').empty();

        //get all customer records
        for (var customer of customers) {

            var row = `<tr><td>${customer.id}</td><td>${customer.name}</td><td>${customer.address}</td><td>${customer.contact}</td><td>${customer.salary}</td><td><button id="btnUpdateCustomer" class="btn btn-outline-info col-12 col-sm-7 col-lg-3 mb-1" data-bs-target="#staticBackdropforupdatecustomer" data-bs-toggle="modal" type="button">Edit</button> <button id="btnDeleteCustomer"  class="btn btn-outline-danger col-12 col-sm-7 col-lg-3  mb-1" type="button">Delete</button></td></tr>`;

            $('#tblCustomer').append(row);

        }
    }

    //auto fill update form
    $('#tblCustomer').on('click', '#btnUpdateCustomer', function () {
        var row = $(this).closest('tr');
        var td = $(row).find("td");

        $('#floatingUpdateCustomerID').val($(td).eq(0).html());
        $('#floatingUpdateName').val($(td).eq(1).html());
        $('#floatingUpdateAddress').val($(td).eq(2).html());
        $('#floatingUpdateContact').val($(td).eq(3).html());
        $('#floatingUpdateSalary').val($(td).eq(4).html());

    });


    //delete customer row
    $('#tblCustomer').on('click', '#btnDeleteCustomer', function () {

        Swal.fire({
            title: 'Are you sure?',
            text: "You won't be able to revert this!",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Yes, delete it!'
        }).then((result) => {
            if (result.isConfirmed) {
                $(this).closest('tr').remove();
                Swal.fire(
                    'Deleted!',
                    'Your file has been deleted.',
                    'success'
                )
            }
        })

    });

    //added Customer Search
    $('#myInput').on('keyup', function () {
        var value = $(this).val().toLowerCase();
        $('#tblCustomer tr').filter(function () {
            $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
        });
    });


    //when press enter input field auto focus
    $('.form-control').on('keydown',function (event){
        if(event.which == 13){
            var index = $('.form-control').index(this) + 1;
            $('.form-control').eq(index).focus();
        }
    });

    //press enter when salary input field  save customer data
    $('#txtSalary').on('keydown',function (event){
        if(event.which == 13){
           $('#btnSaveCustomer').focus();
        }
    });

    //save sweet alert
    function saveAlert(){
        Swal.fire({
            position: 'top-end',
            icon: 'success',
            title: 'Your work has been saved',
            showConfirmButton: false,
            timer: 1500
        })
    }



</script>
</body>
</html>